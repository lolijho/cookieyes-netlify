<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test CookieYes Clone</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            line-height: 1.6;
        }
        .content {
            background: #f5f5f5;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
        }
        .script-example {
            background: #333;
            color: #fff;
            padding: 15px;
            border-radius: 4px;
            font-family: monospace;
            margin: 10px 0;
        }
        button {
            background: #007cba;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover {
            background: #005a87;
        }
    </style>
</head>
<body>
    <h1>Test CookieYes Clone</h1>
    
    <div class="content">
        <h2>Benvenuto nella pagina di test</h2>
        <p>Questa pagina serve per testare il funzionamento del banner cookie e del Google Consent Mode v2.</p>
        
        <h3>Script di test presenti:</h3>
        
        <h4>Google Analytics (Analytics)</h4>
        <div class="script-example">
            &lt;script type="text/plain" data-cookie-category="analytics"&gt;<br>
            &nbsp;&nbsp;console.log('Google Analytics caricato!');<br>
            &lt;/script&gt;
        </div>
        
        <h4>Facebook Pixel (Marketing)</h4>
        <div class="script-example">
            &lt;script type="text/plain" data-cookie-category="marketing"&gt;<br>
            &nbsp;&nbsp;console.log('Facebook Pixel caricato!');<br>
            &lt;/script&gt;
        </div>
        
        <h4>Script di preferenze (Preferences)</h4>
        <div class="script-example">
            &lt;script type="text/plain" data-cookie-category="preferences"&gt;<br>
            &nbsp;&nbsp;console.log('Script preferenze caricato!');<br>
            &lt;/script&gt;
        </div>
    </div>
    
    <div class="content">
        <h3>Controlli di test</h3>
        <button onclick="window.CookieYes && window.CookieYes.showBanner()">Mostra Banner</button>
        <button onclick="window.CookieYes && window.CookieYes.showSettings()">Mostra Impostazioni</button>
        <button onclick="checkConsents()">Controlla Consensi</button>
        <button onclick="checkDataLayer()">Controlla DataLayer</button>
    </div>
    
    <div class="content">
        <h3>Log Console</h3>
        <div id="log" style="background: #fff; padding: 10px; border: 1px solid #ddd; height: 200px; overflow-y: auto; font-family: monospace; font-size: 12px;"></div>
    </div>

    <!-- Script di test con categorie -->
    <script type="text/plain" data-cookie-category="analytics">
        console.log('‚úÖ Google Analytics script caricato!');
        logToPage('‚úÖ Google Analytics script caricato!');
    </script>

    <script type="text/plain" data-cookie-category="marketing">
        console.log('‚úÖ Facebook Pixel script caricato!');
        logToPage('‚úÖ Facebook Pixel script caricato!');
    </script>

    <script type="text/plain" data-cookie-category="preferences">
        console.log('‚úÖ Script preferenze caricato!');
        logToPage('‚úÖ Script preferenze caricato!');
    </script>

    <!-- Script sempre attivo -->
    <script>
        function logToPage(message) {
            const log = document.getElementById('log');
            const time = new Date().toLocaleTimeString();
            log.innerHTML += `[${time}] ${message}\n`;
            log.scrollTop = log.scrollHeight;
        }

        function checkConsents() {
            if (window.CookieYes) {
                const analytics = window.CookieYes.getConsent('analytics');
                const marketing = window.CookieYes.getConsent('marketing');
                const preferences = window.CookieYes.getConsent('preferences');
                
                logToPage(`Consensi attuali:`);
                logToPage(`- Analytics: ${analytics}`);
                logToPage(`- Marketing: ${marketing}`);
                logToPage(`- Preferences: ${preferences}`);
            } else {
                logToPage('‚ùå CookieYes non ancora caricato');
            }
        }

        function checkDataLayer() {
            if (window.dataLayer) {
                logToPage(`DataLayer presente con ${window.dataLayer.length} elementi`);
                logToPage(`Ultimi eventi: ${JSON.stringify(window.dataLayer.slice(-3))}`);
            } else {
                logToPage('‚ùå DataLayer non presente');
            }
        }

        // Log iniziale
        document.addEventListener('DOMContentLoaded', function() {
            logToPage('üöÄ Pagina di test caricata');
            logToPage('Attendendo caricamento CookieYes...');
        });

        // Monitora il dataLayer
        window.dataLayer = window.dataLayer || [];
        const originalPush = window.dataLayer.push;
        window.dataLayer.push = function() {
            const result = originalPush.apply(this, arguments);
            logToPage(`üìä DataLayer evento: ${JSON.stringify(arguments[0])}`);
            return result;
        };
    </script>

    <!-- CookieYes Script - Sostituisci PROJECT_ID con l'ID del tuo progetto -->
    <script>
        (function() {
            var script = document.createElement('script');
            script.src = 'http://localhost:3000/embed/64810a56-270e-43bf-9736-154e6bddf1f8';
            script.async = true;
            script.onload = function() {
                logToPage('‚úÖ CookieYes script caricato!');
            };
            script.onerror = function() {
                logToPage('‚ùå Errore nel caricamento CookieYes script');
            };
            document.head.appendChild(script);
        })();
    </script>
</body>
</html>

